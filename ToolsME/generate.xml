<?xml version="1.0" encoding="UTF-8"?>
<project name="UtilMEGen" default="build-generate" basedir=".">


    <import file="nbproject/build-impl.xml"/>

    <property name="lib.dir" value="./lib"/>
    <property name="src.dir" value="./src"/>

    <path id="class.path">
        <fileset dir="${lib.dir}">
            <include name="**/*.jar" />
        </fileset>
    </path>



    <target name="build-generate" description="build first then generate the persistance manager class">

        <delete dir="${basedir}/src/net/yura/mobile/gen/" includes="**"/>

        <antcall target="jar"/>
        <antcall target="generate"/>
    </target>


    <target name="generate" description="generate the persistance manager class">
        <echo message="libs =${lib.dir}"/>
        <echo message="class.path =${class.path}"/>

        <taskdef classname="net.yura.tools.mobilegen.MobileXmlGen" classpath="./dist/${ant.project.name}.jar" name="gen-xml"/>
        <gen-xml
            generatedFile="${basedir}/src/net/yura/mobile/gen/XMLAccess.java"
            classNamesFile="${basedir}/generate.properties"/>

        <taskdef classname="net.yura.tools.mobilegen.MobileBinGen" classpath="./dist/${ant.project.name}.jar" name="gen-bin"/>
        <gen-bin
            generatedFile="${basedir}/src/net/yura/mobile/gen/BinAccess.java"
            classNamesFile="${basedir}/generate.properties"/>



        <taskdef classname="net.yura.tools.mobilegen.proto.MobileProtoGen" classpath="./dist/${ant.project.name}.jar" name="gen-proto"/>
        <gen-proto
            protoSource="${basedir}/test.proto"
            objectPackage="net.yura.tools.mobilegen.model"
            outputPackage="net.yura.mobile.gen"
            outputClass="ProtoAccess"
            sourceRoot="${basedir}/src"/>
    </target>

</project>
